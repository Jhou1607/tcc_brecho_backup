<div class="filtros-container">
  <!-- Header -->
  <div class="page-header">
    <h1>Gerenciar Filtros</h1>
    <p class="subtitle">Controle a visibilidade dos filtros por categoria</p>
  </div>

  <!-- BotÃµes das Categorias -->
  <div class="categorias-grid">
    <div 
      *ngFor="let categoria of categorias" 
      class="categoria-card"
      (click)="abrirPopUpCategoria(categoria)">
      
      <div class="categoria-icon">
        <nz-icon [nzType]="categoria.icon"></nz-icon>
      </div>
      
      <div class="categoria-info">
        <h3>{{ categoria.nome }}</h3>
        <p>{{ categoria.descricao }}</p>
        <div class="categoria-stats">
          <span class="ativos">{{ getFiltrosAtivos(categoria.tipo) }} ativos</span>
          <span class="total">/ {{ getFiltrosTotal(categoria.tipo) }} total</span>
        </div>
      </div>
      
      <div class="categoria-arrow">
        <nz-icon nzType="right"></nz-icon>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <nz-spin nzSize="large"></nz-spin>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && filtros.length === 0" class="empty-container">
    <nz-empty nzNotFoundImage="simple" nzNotFoundContent="Nenhum filtro encontrado"></nz-empty>
  </div>
</div>

<!-- Pop-up de Categoria -->
<nz-modal
  [(nzVisible)]="isPopUpVisible"
  [nzTitle]="categoriaSelecionada?.nome"
  [nzFooter]="null"
  [nzClosable]="true"
  [nzMaskClosable]="true"
  (nzOnCancel)="fecharPopUp()"
  [nzWidth]="'800px'"
  [nzStyle]="{ top: '20px' }">
  
  <ng-container *nzModalContent>
    <div class="popup-content">
      <!-- Barra de Pesquisa -->
      <div class="search-section">
        <input 
          nz-input 
          placeholder="Pesquisar filtros..."
          [(ngModel)]="termoPesquisa"
          (ngModelChange)="filtrarFiltros()" />
      </div>

      <!-- Lista de Filtros da Categoria -->
      <div class="filtros-lista">
        <div 
          *ngFor="let filtro of filtrosFiltrados" 
          class="filtro-item"
          [class.inactive]="!filtro.is_active">
          
          <div class="filtro-info">
            <span class="filtro-label" [class.inactive-text]="!filtro.is_active">
              {{ filtro.label }}
            </span>
            <span class="filtro-value" [class.inactive-text]="!filtro.is_active">
              ({{ filtro.value }})
            </span>
          </div>
          
          <div class="filtro-actions">
            <nz-tag 
              [nzColor]="filtro.is_active ? 'green' : 'red'"
              (click)="toggleFilterStatus(filtro.id)">
              {{ filtro.is_active ? 'Ativo' : 'Inativo' }}
            </nz-tag>
            
            <button 
              nz-button 
              nzType="text" 
              nzSize="small"
              (click)="toggleFilterStatus(filtro.id)"
              class="visibility-btn"
              [class.inactive-btn]="!filtro.is_active"
              [title]="filtro.is_active ? 'Clique para desativar' : 'Clique para ativar'">
              <nz-icon [nzType]="filtro.is_active ? 'eye' : 'eye-invisible'"></nz-icon>
            </button>
          </div>
        </div>
      </div>

      <!-- Contadores -->
      <div class="filtros-summary">
        <span class="summary-text">
          {{ filtrosFiltrados.length }} filtros encontrados
        </span>
        <span class="summary-active">
          {{ getFiltrosAtivos(categoriaSelecionada?.tipo ?? '') }} ativos
        </span>
      </div>
    </div>
  </ng-container>
</nz-modal> 